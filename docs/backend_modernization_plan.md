# –ü–ª–∞–Ω –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ Backend

## üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ö–æ—Ä–æ—à–æ
1. **–ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FastAPI** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - —Ä–∞–±–æ—á–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–æ–∫–µ–Ω–æ–≤
3. **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–æ–º–µ–Ω–∞–º (ecommerce, social, tasks, content, analytics)
4. **SQLAlchemy –º–æ–¥–µ–ª–∏** - –±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
5. **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è frontend
6. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - PostgreSQL —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã

#### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Pydantic —Å—Ö–µ–º –¥–ª—è –º–æ–¥—É–ª–µ–π**
- –¢–æ–ª—å–∫–æ —Å—Ö–µ–º—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥—É–ª–µ–π
- –ù–µ—Ç —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ API responses

#### 2. **–ù–µ–ø–æ–ª–Ω—ã–µ API endpoints**
- –ú–Ω–æ–≥–æ endpoints –ø—Ä–∏–Ω–∏–º–∞—é—Ç `dict` –≤–º–µ—Å—Ç–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç endpoints –¥–ª—è –º–Ω–æ–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∏—Å–∫–∞

#### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**
- –ù–µ—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è
- –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

#### 4. **–°–ª–∞–±–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –ë–∞–∑–æ–≤—ã–µ HTTPException
- –ù–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

#### 5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π**
- –ù–µ—Ç email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ù–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
- –ù–µ—Ç —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ù–µ—Ç rate limiting

## üéØ –ü–ª–∞–Ω –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –°—Ö–µ–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è (–ö—Ä–∏—Ç–∏—á–Ω–æ)

#### 1.1 –°–æ–∑–¥–∞—Ç—å Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
```python
# schemas/ecommerce.py
class ProductBase(BaseModel):
    name: str
    description: Optional[str] = None
    price: float
    category: str
    image_url: Optional[str] = None
    stock_quantity: int = 0

class ProductCreate(ProductBase):
    pass

class ProductUpdate(BaseModel):
    name: Optional[str] = None
    description: Optional[str] = None
    price: Optional[float] = None
    category: Optional[str] = None
    image_url: Optional[str] = None
    stock_quantity: Optional[int] = None
    is_active: Optional[bool] = None

class ProductResponse(ProductBase):
    id: int
    is_active: bool
    created_at: datetime
    updated_at: datetime
    
    class Config:
        from_attributes = True

class CartItemCreate(BaseModel):
    product_id: int
    quantity: int = 1

class CartItemResponse(BaseModel):
    id: int
    product: ProductResponse
    quantity: int
    created_at: datetime
    
    class Config:
        from_attributes = True

class OrderCreate(BaseModel):
    shipping_address: str
    payment_method: str

class OrderResponse(BaseModel):
    id: int
    total_amount: float
    status: str
    shipping_address: str
    payment_method: str
    created_at: datetime
    order_items: List[OrderItemResponse]
    
    class Config:
        from_attributes = True
```

#### 1.2 –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—ã –¥–ª—è Social Network
```python
# schemas/social.py
class PostCreate(BaseModel):
    content: str
    image_url: Optional[str] = None
    is_public: bool = True

class PostUpdate(BaseModel):
    content: Optional[str] = None
    image_url: Optional[str] = None
    is_public: Optional[bool] = None

class PostResponse(BaseModel):
    id: int
    content: str
    image_url: Optional[str]
    is_public: bool
    created_at: datetime
    updated_at: datetime
    author: UserResponse
    likes_count: int
    comments_count: int
    
    class Config:
        from_attributes = True

class CommentCreate(BaseModel):
    content: str

class CommentResponse(BaseModel):
    id: int
    content: str
    created_at: datetime
    author: UserResponse
    
    class Config:
        from_attributes = True
```

#### 1.3 –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—ã –¥–ª—è Task Management
```python
# schemas/tasks.py
class BoardCreate(BaseModel):
    name: str
    description: Optional[str] = None
    is_public: bool = False

class BoardResponse(BaseModel):
    id: int
    name: str
    description: Optional[str]
    is_public: bool
    created_at: datetime
    cards: List[CardResponse]
    
    class Config:
        from_attributes = True

class CardCreate(BaseModel):
    title: str
    description: Optional[str] = None
    priority: str = "medium"
    deadline: Optional[datetime] = None

class CardUpdate(BaseModel):
    title: Optional[str] = None
    description: Optional[str] = None
    priority: Optional[str] = None
    status: Optional[str] = None
    deadline: Optional[datetime] = None
    assigned_to_id: Optional[int] = None

class CardResponse(BaseModel):
    id: int
    title: str
    description: Optional[str]
    priority: str
    status: str
    deadline: Optional[datetime]
    created_at: datetime
    assigned_to: Optional[UserResponse]
    comments: List[CardCommentResponse]
    
    class Config:
        from_attributes = True
```

### –§–∞–∑–∞ 2: –£–ª—É—á—à–µ–Ω–∏–µ API endpoints (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 2.1 E-commerce –º–æ–¥—É–ª—å
```python
# api/ecommerce.py - —É–ª—É—á—à–µ–Ω–Ω—ã–µ endpoints
@router.get("/api/ecommerce/products", response_model=List[ProductResponse])
def get_products(
    skip: int = 0, 
    limit: int = 20,
    category: Optional[str] = None,
    search: Optional[str] = None,
    min_price: Optional[float] = None,
    max_price: Optional[float] = None,
    db: Session = Depends(get_db)
):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–æ–∏—Å–∫–æ–º"""
    query = db.query(ecommerce_models.Product).filter(
        ecommerce_models.Product.is_active == True
    )
    
    if category:
        query = query.filter(ecommerce_models.Product.category == category)
    if search:
        query = query.filter(
            or_(
                ecommerce_models.Product.name.ilike(f"%{search}%"),
                ecommerce_models.Product.description.ilike(f"%{search}%")
            )
        )
    if min_price:
        query = query.filter(ecommerce_models.Product.price >= min_price)
    if max_price:
        query = query.filter(ecommerce_models.Product.price <= max_price)
    
    products = query.offset(skip).limit(limit).all()
    return products

@router.post("/api/ecommerce/products", response_model=ProductResponse)
def create_product(
    product: schemas.ProductCreate,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä"""
    db_product = ecommerce_models.Product(**product.dict())
    db.add(db_product)
    db.commit()
    db.refresh(db_product)
    return db_product

@router.put("/api/ecommerce/products/{product_id}", response_model=ProductResponse)
def update_product(
    product_id: int,
    product_update: schemas.ProductUpdate,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä"""
    product = db.query(ecommerce_models.Product).filter(
        ecommerce_models.Product.id == product_id
    ).first()
    
    if not product:
        raise HTTPException(status_code=404, detail="Product not found")
    
    update_data = product_update.dict(exclude_unset=True)
    for field, value in update_data.items():
        setattr(product, field, value)
    
    db.commit()
    db.refresh(product)
    return product

@router.delete("/api/ecommerce/products/{product_id}")
def delete_product(
    product_id: int,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)"""
    product = db.query(ecommerce_models.Product).filter(
        ecommerce_models.Product.id == product_id
    ).first()
    
    if not product:
        raise HTTPException(status_code=404, detail="Product not found")
    
    product.is_active = False
    db.commit()
    return {"message": "Product deleted successfully"}

@router.get("/api/ecommerce/cart", response_model=List[CartItemResponse])
def get_cart(
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    cart_items = (
        db.query(ecommerce_models.CartItem)
        .filter(ecommerce_models.CartItem.user_id == current_user.id)
        .all()
    )
    return cart_items

@router.post("/api/ecommerce/cart", response_model=CartItemResponse)
def add_to_cart(
    cart_item: schemas.CartItemCreate,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É"""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
    product = db.query(ecommerce_models.Product).filter(
        ecommerce_models.Product.id == cart_item.product_id
    ).first()
    
    if not product:
        raise HTTPException(status_code=404, detail="Product not found")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–µ
    if product.stock_quantity < cart_item.quantity:
        raise HTTPException(
            status_code=400, 
            detail="Not enough stock available"
        )
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω–µ
    existing_item = (
        db.query(ecommerce_models.CartItem)
        .filter(
            ecommerce_models.CartItem.user_id == current_user.id,
            ecommerce_models.CartItem.product_id == cart_item.product_id,
        )
        .first()
    )
    
    if existing_item:
        existing_item.quantity += cart_item.quantity
        db.commit()
        db.refresh(existing_item)
        return existing_item
    else:
        new_item = ecommerce_models.CartItem(
            user_id=current_user.id,
            product_id=cart_item.product_id,
            quantity=cart_item.quantity
        )
        db.add(new_item)
        db.commit()
        db.refresh(new_item)
        return new_item

@router.put("/api/ecommerce/cart/{item_id}", response_model=CartItemResponse)
def update_cart_item(
    item_id: int,
    quantity: int,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ"""
    cart_item = (
        db.query(ecommerce_models.CartItem)
        .filter(
            ecommerce_models.CartItem.id == item_id,
            ecommerce_models.CartItem.user_id == current_user.id
        )
        .first()
    )
    
    if not cart_item:
        raise HTTPException(status_code=404, detail="Cart item not found")
    
    if quantity <= 0:
        db.delete(cart_item)
        db.commit()
        return {"message": "Item removed from cart"}
    
    cart_item.quantity = quantity
    db.commit()
    db.refresh(cart_item)
    return cart_item

@router.delete("/api/ecommerce/cart/{item_id}")
def remove_from_cart(
    item_id: int,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã"""
    cart_item = (
        db.query(ecommerce_models.CartItem)
        .filter(
            ecommerce_models.CartItem.id == item_id,
            ecommerce_models.CartItem.user_id == current_user.id
        )
        .first()
    )
    
    if not cart_item:
        raise HTTPException(status_code=404, detail="Cart item not found")
    
    db.delete(cart_item)
    db.commit()
    return {"message": "Item removed from cart"}

@router.post("/api/ecommerce/checkout", response_model=OrderResponse)
def checkout(
    order_data: schemas.OrderCreate,
    current_user: models.User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    """–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑"""
    # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
    cart_items = (
        db.query(ecommerce_models.CartItem)
        .filter(ecommerce_models.CartItem.user_id == current_user.id)
        .all()
    )
    
    if not cart_items:
        raise HTTPException(status_code=400, detail="Cart is empty")
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É
    total_amount = 0
    for item in cart_items:
        total_amount += item.product.price * item.quantity
    
    # –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
    order = ecommerce_models.Order(
        user_id=current_user.id,
        total_amount=total_amount,
        status="pending",
        shipping_address=order_data.shipping_address,
        payment_method=order_data.payment_method
    )
    db.add(order)
    db.flush()  # –ü–æ–ª—É—á–∞–µ–º ID –∑–∞–∫–∞–∑–∞
    
    # –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–∫–∞–∑–∞
    for item in cart_items:
        order_item = ecommerce_models.OrderItem(
            order_id=order.id,
            product_id=item.product_id,
            quantity=item.quantity,
            price=item.product.price
        )
        db.add(order_item)
    
    # –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
    db.query(ecommerce_models.CartItem).filter(
        ecommerce_models.CartItem.user_id == current_user.id
    ).delete()
    
    db.commit()
    db.refresh(order)
    return order
```

### –§–∞–∑–∞ 3: –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 3.1 –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è
```python
# services/ecommerce_service.py
class EcommerceService:
    def __init__(self, db: Session):
        self.db = db
    
    def get_products(
        self, 
        skip: int = 0, 
        limit: int = 20,
        filters: Optional[dict] = None
    ) -> List[Product]:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
        query = self.db.query(Product).filter(Product.is_active == True)
        
        if filters:
            if filters.get("category"):
                query = query.filter(Product.category == filters["category"])
            if filters.get("search"):
                query = query.filter(
                    or_(
                        Product.name.ilike(f"%{filters['search']}%"),
                        Product.description.ilike(f"%{filters['search']}%")
                    )
                )
            if filters.get("min_price"):
                query = query.filter(Product.price >= filters["min_price"])
            if filters.get("max_price"):
                query = query.filter(Product.price <= filters["max_price"])
        
        return query.offset(skip).limit(limit).all()
    
    def create_product(self, product_data: ProductCreate) -> Product:
        """–°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä"""
        product = Product(**product_data.dict())
        self.db.add(product)
        self.db.commit()
        self.db.refresh(product)
        return product
    
    def update_product(self, product_id: int, product_data: ProductUpdate) -> Product:
        """–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä"""
        product = self.db.query(Product).filter(Product.id == product_id).first()
        if not product:
            raise HTTPException(status_code=404, detail="Product not found")
        
        update_data = product_data.dict(exclude_unset=True)
        for field, value in update_data.items():
            setattr(product, field, value)
        
        self.db.commit()
        self.db.refresh(product)
        return product
    
    def delete_product(self, product_id: int) -> bool:
        """–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)"""
        product = self.db.query(Product).filter(Product.id == product_id).first()
        if not product:
            raise HTTPException(status_code=404, detail="Product not found")
        
        product.is_active = False
        self.db.commit()
        return True
```

### –§–∞–∑–∞ 4: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 4.1 Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
```python
# services/email_service.py
class EmailService:
    def __init__(self):
        self.smtp_server = settings.SMTP_SERVER
        self.smtp_port = settings.SMTP_PORT
        self.smtp_username = settings.SMTP_USERNAME
        self.smtp_password = settings.SMTP_PASSWORD
    
    def send_verification_email(self, user: User, token: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å email –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏"""
        verification_url = f"{settings.FRONTEND_URL}/verify-email?token={token}"
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email
    
    def send_password_reset_email(self, user: User, token: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å email –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è"""
        reset_url = f"{settings.FRONTEND_URL}/reset-password?token={token}"
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email
```

#### 4.2 –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
```python
# models/roles.py
class Role(Base):
    __tablename__ = "roles"
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(50), unique=True, nullable=False)
    description = Column(String(255))
    permissions = Column(JSON)  # –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
    
class UserRole(Base):
    __tablename__ = "user_roles"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    role_id = Column(Integer, ForeignKey("roles.id"), nullable=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
```

#### 4.3 Rate Limiting
```python
# middleware/rate_limiting.py
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address
from slowapi.errors import RateLimitExceeded

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)

# –í —Ä–æ—É—Ç–µ—Ä–∞—Ö
@router.post("/api/auth/login")
@limiter.limit("5/minute")
def login_user(request: Request, ...):
    # –õ–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞
```

### –§–∞–∑–∞ 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 5.1 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# utils/logging.py
import logging
from pythonjsonlogger import jsonlogger

def setup_logging():
    logHandler = logging.StreamHandler()
    formatter = jsonlogger.JsonFormatter()
    logHandler.setFormatter(formatter)
    logger = logging.getLogger()
    logger.addHandler(logHandler)
    logger.setLevel(logging.INFO)
    return logger
```

#### 5.2 –ú–µ—Ç—Ä–∏–∫–∏
```python
# middleware/metrics.py
from prometheus_client import Counter, Histogram, generate_latest

REQUEST_COUNT = Counter('http_requests_total', 'Total HTTP requests', ['method', 'endpoint'])
REQUEST_DURATION = Histogram('http_request_duration_seconds', 'HTTP request duration')

@app.middleware("http")
async def metrics_middleware(request: Request, call_next):
    start_time = time.time()
    response = await call_next(request)
    duration = time.time() - start_time
    
    REQUEST_COUNT.labels(method=request.method, endpoint=request.url.path).inc()
    REQUEST_DURATION.observe(duration)
    
    return response
```

## üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ù–µ–¥–µ–ª—è 1: –°—Ö–µ–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å –≤—Å–µ Pydantic —Å—Ö–µ–º—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

### –ù–µ–¥–µ–ª—è 2: E-commerce –º–æ–¥—É–ª—å
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è E-commerce API
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –ø–æ–∏—Å–∫
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É –∏ –∑–∞–∫–∞–∑—ã

### –ù–µ–¥–µ–ª—è 3: Social Network –º–æ–¥—É–ª—å
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Social API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–∞–π–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏

### –ù–µ–¥–µ–ª—è 4: Task Management –º–æ–¥—É–ª—å
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Tasks API
- [ ] –î–æ–±–∞–≤–∏—Ç—å Kanban —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞—á

### –ù–µ–¥–µ–ª—è 5: Content Management –º–æ–¥—É–ª—å
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Content API
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å—è–º–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ–¥–∏–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫—É

### –ù–µ–¥–µ–ª—è 6: Analytics –º–æ–¥—É–ª—å
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Analytics API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –∏ –æ—Ç—á–µ—Ç—ã
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### –ù–µ–¥–µ–ª—è 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- [ ] Performance —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API responses
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API < 500ms
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã
- ‚úÖ Rate limiting
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ Health checks

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```txt
# –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
slowapi==0.1.9  # Rate limiting
python-multipart==0.0.6  # File uploads
python-jose[cryptography]==3.3.0  # JWT
passlib[bcrypt]==1.7.4  # Password hashing
python-json-logger==2.0.7  # JSON logging
prometheus-client==0.19.0  # Metrics
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
# config.py - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
class Settings(BaseSettings):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ...
    
    # Email settings
    SMTP_SERVER: str = "smtp.gmail.com"
    SMTP_PORT: int = 587
    SMTP_USERNAME: str = ""
    SMTP_PASSWORD: str = ""
    
    # Frontend URL
    FRONTEND_URL: str = "http://localhost:3000"
    
    # Rate limiting
    RATE_LIMIT_ENABLED: bool = True
    
    # Logging
    LOG_LEVEL: str = "INFO"
    LOG_FORMAT: str = "json"
```

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏—Ç –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ backend'–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
